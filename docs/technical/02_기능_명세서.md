# System Informer 기능 명세서

## 문서 정보
- **프로젝트명**: System Informer
- **문서 버전**: 1.0
- **작성일**: 2026-01-25

---

## 1. 기능 개요

System Informer는 Windows 시스템의 포괄적인 모니터링 및 관리 도구로, 다음과 같은 주요 기능 카테고리를 제공합니다.

```
┌─────────────────────────────────────────────────────────────────┐
│                      System Informer 기능 맵                     │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐       │
│  │ 프로세스 관리  │  │  스레드 관리   │  │  핸들 관리    │       │
│  └───────────────┘  └───────────────┘  └───────────────┘       │
│                                                                 │
│  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐       │
│  │  메모리 분석   │  │ 네트워크 모니터│  │  모듈 분석    │       │
│  └───────────────┘  └───────────────┘  └───────────────┘       │
│                                                                 │
│  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐       │
│  │  서비스 관리   │  │  디스크 모니터 │  │  GPU 모니터   │       │
│  └───────────────┘  └───────────────┘  └───────────────┘       │
│                                                                 │
│  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐       │
│  │  시스템 정보   │  │   보안 분석   │  │  플러그인     │       │
│  └───────────────┘  └───────────────┘  └───────────────┘       │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 2. 프로세스 관리 기능

### 2.1 프로세스 목록 표시

**기능 ID**: PROC-001
**소스 파일**: `SystemInformer/proctree.c`, `SystemInformer/procprv.c`

#### 기능 설명
시스템에서 실행 중인 모든 프로세스를 트리 또는 목록 형태로 표시합니다.

#### 표시 정보

| 컬럼 | 설명 | 구현 위치 |
|------|------|-----------|
| Name | 프로세스 이름 | `procprv.c:PhpProcessQueryName` |
| PID | 프로세스 ID | 시스템 정보 |
| CPU | CPU 사용률 (%) | `procprv.c:PhpProcessCalculateCpu` |
| I/O Total Rate | 초당 I/O 바이트 | 델타 계산 |
| Private Bytes | 개인 메모리 사용량 | 시스템 정보 |
| User Name | 실행 사용자 | 토큰 정보 |
| Description | 파일 설명 | 버전 정보 |
| Company Name | 제조사 | 버전 정보 |
| Command Line | 명령줄 | PEB 정보 |
| DEP | 데이터 실행 방지 상태 | 프로세스 정보 |
| ASLR | 주소 공간 무작위화 | 이미지 정보 |
| Integrity | 무결성 레벨 | 토큰 정보 |
| Verified Signer | 디지털 서명자 | `verify.c` |

#### 사용자 시나리오

```
사용자 → 메인 윈도우 열기
       → 프로세스 목록 확인
       → 특정 프로세스 선택
       → 상세 정보 확인 또는 작업 수행
```

---

### 2.2 프로세스 트리 뷰

**기능 ID**: PROC-002
**소스 파일**: `SystemInformer/proctree.c`

#### 기능 설명
부모-자식 관계를 트리 구조로 표시하여 프로세스 계층 구조를 시각화합니다.

#### 트리 구조 예시

```
System (4)
├── smss.exe (392)
│   └── csrss.exe (508)
├── services.exe (620)
│   ├── svchost.exe (812)
│   │   └── WmiPrvSE.exe (2340)
│   ├── svchost.exe (844)
│   └── spoolsv.exe (1280)
├── lsass.exe (636)
└── winlogon.exe (580)
    └── explorer.exe (1856)
        ├── notepad.exe (3456)
        └── chrome.exe (4520)
```

#### 기능 옵션

- **트리 모드 토글**: 트리/플랫 목록 전환
- **자식 하이라이트**: 선택된 프로세스의 자식 강조
- **부모 추적**: 선택된 프로세스의 부모로 이동

---

### 2.3 프로세스 작업

**기능 ID**: PROC-003
**소스 파일**: `SystemInformer/actions.c`

#### 지원 작업 목록

| 작업 | 설명 | 필요 권한 | 구현 함수 |
|------|------|-----------|-----------|
| Terminate | 프로세스 종료 | PROCESS_TERMINATE | `PhUiTerminateProcess` |
| Terminate Tree | 프로세스 트리 종료 | PROCESS_TERMINATE | `PhUiTerminateProcesses` |
| Suspend | 프로세스 일시 중지 | PROCESS_SUSPEND_RESUME | `PhUiSuspendProcess` |
| Resume | 프로세스 재개 | PROCESS_SUSPEND_RESUME | `PhUiResumeProcess` |
| Restart | 프로세스 재시작 | 다중 권한 | `PhUiRestartProcess` |
| Reduce Working Set | 워킹셋 축소 | PROCESS_SET_QUOTA | `PhUiReduceWorkingSet` |
| Virtualization | 가상화 토글 | TOKEN_WRITE | `PhUiSetVirtualization` |
| Create Dump | 덤프 파일 생성 | PROCESS_ALL_ACCESS | `PhUiCreateDumpFile` |
| Debug | 디버거 연결 | PROCESS_ALL_ACCESS | `PhUiDebugProcess` |
| Inject DLL | DLL 주입 | PROCESS_ALL_ACCESS | `PhUiInjectDll` |
| Set Priority | 우선순위 변경 | PROCESS_SET_INFORMATION | `PhUiSetPriority` |
| Set I/O Priority | I/O 우선순위 변경 | PROCESS_SET_INFORMATION | `PhUiSetIoPriority` |
| Set Affinity | CPU 친화도 설정 | PROCESS_SET_INFORMATION | `PhUiSetAffinity` |

#### 강제 종료 메커니즘

```
일반 종료 실패 시:
┌─────────────────────────────────────────┐
│ 1. NtTerminateProcess 시도              │
│         ↓ 실패                          │
│ 2. KSystemInformer 드라이버 사용        │
│         ↓ 실패                          │
│ 3. 스레드 개별 종료 시도                │
│         ↓ 실패                          │
│ 4. 사용자에게 실패 알림                 │
└─────────────────────────────────────────┘
```

---

### 2.4 프로세스 속성

**기능 ID**: PROC-004
**소스 파일**: `SystemInformer/prpg*.c`

#### 속성 페이지 목록

| 페이지 | 소스 파일 | 표시 정보 |
|--------|-----------|-----------|
| General | `prpggen.c` | 기본 정보, 이미지 경로, 명령줄 |
| Statistics | `prpgstat.c` | CPU, 메모리, I/O 통계 |
| Performance | `prpgperf.c` | 성능 그래프 |
| Threads | `prpgthrd.c` | 스레드 목록 |
| Token | `tokprp.c` | 보안 토큰, 권한, 그룹 |
| Modules | `prpgmod.c` | 로드된 모듈 |
| Memory | `prpgmem.c` | 메모리 맵 |
| Handles | `prpghndl.c` | 열린 핸들 |
| Environment | `prpgenv.c` | 환경 변수 |
| Job | `prpgjob.c` | 잡 객체 정보 |
| Services | `prpgsrv.c` | 호스팅된 서비스 |
| WMI Providers | `prpgwmi.c` | WMI 공급자 |
| .NET | Plugin | .NET 어셈블리 (플러그인) |
| GPU | Plugin | GPU 사용량 (플러그인) |

---

## 3. 스레드 관리 기능

### 3.1 스레드 목록

**기능 ID**: THRD-001
**소스 파일**: `SystemInformer/thrdprv.c`, `SystemInformer/thrdlist.c`

#### 표시 정보

| 컬럼 | 설명 |
|------|------|
| TID | 스레드 ID |
| CPU | CPU 사용률 |
| Cycles Delta | 사이클 델타 |
| Start Address | 시작 주소 (심볼 해석) |
| Priority | 스레드 우선순위 |
| State | 실행 상태 (Running, Waiting 등) |
| Start Time | 시작 시간 |
| Kernel Time | 커널 모드 시간 |
| User Time | 사용자 모드 시간 |

#### 스레드 작업

```
┌─────────────────────────────────────────────────────┐
│                 스레드 컨텍스트 메뉴                  │
├─────────────────────────────────────────────────────┤
│ • Terminate                 - 스레드 종료           │
│ • Force Terminate           - 강제 종료             │
│ • Suspend                   - 일시 중지             │
│ • Resume                    - 재개                  │
│ • Set Priority              - 우선순위 변경          │
│ • Set I/O Priority          - I/O 우선순위          │
│ • Set Affinity              - CPU 친화도            │
│ • Analyze Wait              - 대기 분석             │
│ • View Stack                - 스택 보기             │
│ • View Token                - 토큰 보기             │
└─────────────────────────────────────────────────────┘
```

### 3.2 스레드 스택 추적

**기능 ID**: THRD-002
**소스 파일**: `phlib/symprv.c`

#### 기능 설명
선택한 스레드의 호출 스택을 심볼과 함께 표시합니다.

#### 스택 프레임 정보

```
Frame #0: ntdll.dll!NtWaitForSingleObject+0x14
Frame #1: KERNELBASE.dll!WaitForSingleObjectEx+0x8e
Frame #2: myapp.exe!WorkerThread+0x125
Frame #3: myapp.exe!main+0x45
Frame #4: KERNEL32.DLL!BaseThreadInitThunk+0x1d
Frame #5: ntdll.dll!RtlUserThreadStart+0x28
```

---

## 4. 핸들 관리 기능

### 4.1 핸들 목록

**기능 ID**: HNDL-001
**소스 파일**: `SystemInformer/hndlprv.c`, `SystemInformer/hndllist.c`

#### 표시 정보

| 컬럼 | 설명 |
|------|------|
| Type | 객체 타입 (File, Key, Event 등) |
| Name | 객체 이름 |
| Handle | 핸들 값 |
| Object Address | 커널 객체 주소 |
| Access | 접근 권한 |
| Attributes | 핸들 속성 |
| Granted Access | 부여된 접근 권한 |
| Original Name | 원본 이름 (해석 전) |

#### 지원 객체 타입

```
┌─────────────────────────────────────────────────────────────┐
│                    지원되는 핸들 타입                         │
├─────────────────────────────────────────────────────────────┤
│ File        파일 및 디렉토리                                 │
│ Key         레지스트리 키                                    │
│ Event       이벤트 객체                                      │
│ Mutant      뮤텍스                                           │
│ Semaphore   세마포어                                         │
│ Section     메모리 섹션                                      │
│ Process     프로세스 핸들                                    │
│ Thread      스레드 핸들                                      │
│ Token       토큰 핸들                                        │
│ Desktop     데스크톱                                         │
│ WindowStation  윈도우 스테이션                               │
│ Timer       타이머                                           │
│ Job         잡 객체                                          │
│ Directory   객체 디렉토리                                    │
│ SymbolicLink  심볼릭 링크                                    │
│ ALPC Port   ALPC 포트                                        │
│ 기타 100+ 타입                                               │
└─────────────────────────────────────────────────────────────┘
```

### 4.2 핸들 검색

**기능 ID**: HNDL-002
**소스 파일**: `SystemInformer/findobj.c`

#### 기능 설명
시스템 전체에서 특정 이름 또는 타입의 핸들을 검색합니다.

#### 검색 옵션

- **이름으로 검색**: 와일드카드 지원 (`*.dll`, `\Device\*`)
- **타입으로 필터링**: 특정 객체 타입만 검색
- **정규식 검색**: 정규 표현식 패턴 지원

---

## 5. 메모리 관리 기능

### 5.1 메모리 맵 뷰어

**기능 ID**: MEM-001
**소스 파일**: `SystemInformer/memprv.c`, `SystemInformer/prpgmem.c`

#### 표시 정보

| 컬럼 | 설명 |
|------|------|
| Base Address | 시작 주소 |
| Size | 영역 크기 |
| Protection | 보호 속성 (RWX) |
| State | 상태 (Commit, Reserve, Free) |
| Type | 타입 (Image, Mapped, Private) |
| Use | 용도 (Stack, Heap, PE 섹션) |
| Mapped File | 매핑된 파일 경로 |

#### 메모리 보호 속성

```
┌────────────────────────────────────────────────────┐
│              메모리 보호 속성                       │
├────────────────────────────────────────────────────┤
│ PAGE_NOACCESS           ---     접근 불가          │
│ PAGE_READONLY           R--     읽기 전용          │
│ PAGE_READWRITE          RW-     읽기/쓰기          │
│ PAGE_EXECUTE            --X     실행 전용          │
│ PAGE_EXECUTE_READ       R-X     읽기/실행          │
│ PAGE_EXECUTE_READWRITE  RWX     전체 권한          │
│ PAGE_GUARD             +G       가드 페이지        │
│ PAGE_NOCACHE           +NC      캐시 비활성화      │
│ PAGE_WRITECOMBINE      +WC      쓰기 결합          │
└────────────────────────────────────────────────────┘
```

### 5.2 메모리 편집기

**기능 ID**: MEM-002
**소스 파일**: `SystemInformer/memedit.c`, `phlib/hexedit.c`

#### 기능 설명
프로세스의 메모리를 16진수 편집기로 읽고 수정합니다.

#### 기능 목록

- **메모리 읽기**: 지정된 주소에서 메모리 읽기
- **메모리 쓰기**: 메모리 내용 수정
- **검색**: 패턴, 문자열, 바이트 검색
- **바이너리 보기**: 16진수 + ASCII 병렬 표시

### 5.3 메모리 검색

**기능 ID**: MEM-003
**소스 파일**: `SystemInformer/memsrch.c`

#### 검색 옵션

| 검색 타입 | 설명 |
|-----------|------|
| String (ASCII) | ASCII 문자열 검색 |
| String (Unicode) | 유니코드 문자열 검색 |
| Hex Pattern | 16진수 패턴 검색 |
| Regex | 정규 표현식 검색 |
| Struct | 구조체 패턴 검색 |

---

## 6. 네트워크 모니터링 기능

### 6.1 네트워크 연결 목록

**기능 ID**: NET-001
**소스 파일**: `SystemInformer/netprv.c`, `SystemInformer/netlist.c`

#### 표시 정보

| 컬럼 | 설명 |
|------|------|
| Process | 프로세스 이름 |
| Local Address | 로컬 주소 |
| Local Port | 로컬 포트 |
| Remote Address | 원격 주소 |
| Remote Port | 원격 포트 |
| Protocol | 프로토콜 (TCP/UDP) |
| State | 연결 상태 |
| Owner | 소유 프로세스 |
| Time Stamp | 연결 시간 |

#### 연결 상태

```
TCP 상태:
┌──────────────┬─────────────────────────────────┐
│ Listening    │ 연결 대기 중                    │
│ Established  │ 연결 수립됨                     │
│ SynSent      │ SYN 패킷 전송됨                 │
│ SynReceived  │ SYN 패킷 수신됨                 │
│ FinWait1/2   │ 종료 대기                       │
│ CloseWait    │ 닫기 대기                       │
│ Closing      │ 닫는 중                         │
│ TimeWait     │ 시간 대기                       │
│ Closed       │ 닫힘                            │
└──────────────┴─────────────────────────────────┘
```

### 6.2 네트워크 작업

**기능 ID**: NET-002

#### 지원 작업

| 작업 | 설명 |
|------|------|
| Close Connection | TCP 연결 종료 |
| Copy | 정보 복사 |
| Go to Process | 소유 프로세스로 이동 |
| Whois | WHOIS 조회 (플러그인) |
| GeoIP | 지리적 위치 조회 (플러그인) |
| Traceroute | 경로 추적 (플러그인) |

---

## 7. 서비스 관리 기능

### 7.1 서비스 목록

**기능 ID**: SVC-001
**소스 파일**: `SystemInformer/srvprv.c`, `SystemInformer/srvlist.c`

#### 표시 정보

| 컬럼 | 설명 |
|------|------|
| Name | 서비스 이름 |
| Display Name | 표시 이름 |
| Type | 서비스 타입 |
| Status | 현재 상태 |
| Start Type | 시작 유형 |
| PID | 프로세스 ID |
| Description | 설명 |
| Binary Path | 실행 파일 경로 |

### 7.2 서비스 작업

**기능 ID**: SVC-002
**소스 파일**: `SystemInformer/srvctl.c`

#### 지원 작업

| 작업 | 설명 |
|------|------|
| Start | 서비스 시작 |
| Stop | 서비스 중지 |
| Pause | 서비스 일시 중지 |
| Continue | 서비스 계속 |
| Restart | 서비스 재시작 |
| Delete | 서비스 삭제 |
| Create | 새 서비스 생성 |
| Properties | 서비스 속성 |

### 7.3 서비스 속성

**기능 ID**: SVC-003

#### 속성 페이지

| 페이지 | 설명 |
|--------|------|
| General | 기본 정보, 시작 유형 |
| Log On | 로그온 계정 설정 |
| Dependencies | 의존성 관계 (플러그인) |
| Recovery | 복구 옵션 (플러그인) |
| Triggers | 트리거 설정 (플러그인) |

---

## 8. 모듈 분석 기능

### 8.1 모듈 목록

**기능 ID**: MOD-001
**소스 파일**: `SystemInformer/modprv.c`, `SystemInformer/modlist.c`

#### 표시 정보

| 컬럼 | 설명 |
|------|------|
| Name | 모듈 이름 |
| Base Address | 기본 주소 |
| Size | 모듈 크기 |
| Description | 설명 |
| Company Name | 제조사 |
| Version | 파일 버전 |
| Path | 전체 경로 |
| Verified Signer | 서명 검증 |
| ASLR | ASLR 적용 여부 |

### 8.2 모듈 작업

**기능 ID**: MOD-002

#### 지원 작업

| 작업 | 설명 |
|------|------|
| Unload | DLL 언로드 |
| Open File Location | 파일 위치 열기 |
| Copy | 정보 복사 |
| Properties | PE 속성 |
| Search Online | 온라인 검색 |
| VirusTotal | VT 검사 (플러그인) |

---

## 9. 시스템 정보 기능

### 9.1 시스템 정보 창

**기능 ID**: SYS-001
**소스 파일**: `SystemInformer/sysinfo.c`

#### 정보 탭

| 탭 | 표시 정보 |
|----|-----------|
| CPU | CPU 사용률 그래프, 코어별 사용률 |
| Memory | 메모리 사용량, 커밋 차지 |
| I/O | 디스크 I/O 그래프 |
| GPU | GPU 사용률 (플러그인) |
| Disk | 디스크 사용률 (플러그인) |
| Network | 네트워크 사용률 (플러그인) |

### 9.2 시스템 정보 상세

**기능 ID**: SYS-002

#### 표시 정보

```
┌─────────────────────────────────────────────────────────────┐
│                      시스템 정보                             │
├─────────────────────────────────────────────────────────────┤
│ OS 버전:        Windows 11 Pro 23H2 (Build 22631)          │
│ 프로세서:       AMD Ryzen 9 5900X (12 cores, 24 threads)   │
│ RAM:            32.0 GB                                     │
│ 시스템 시작:    2026-01-20 09:15:23                         │
│ 부팅 시간:      45초                                        │
│ 프로세스 수:    287                                         │
│ 스레드 수:      4,521                                       │
│ 핸들 수:        152,847                                     │
│ 커밋 차지:      8.2 / 48.0 GB                               │
│ 커널 풀:        Paged: 512 MB / Nonpaged: 256 MB           │
└─────────────────────────────────────────────────────────────┘
```

---

## 10. 검색 및 필터링 기능

### 10.1 전역 검색

**기능 ID**: SRCH-001
**소스 파일**: `SystemInformer/searchbox.c`

#### 검색 대상

- 프로세스 이름
- 서비스 이름
- 네트워크 연결
- 핸들 이름
- 모듈 이름

### 10.2 고급 필터

**기능 ID**: SRCH-002

#### 필터 옵션

```
필터 연산자:
┌────────────────────────────────────────────────────┐
│ contains      - 포함                               │
│ equals        - 일치                               │
│ startswith    - 시작                               │
│ endswith      - 끝                                 │
│ regex         - 정규식                             │
│ >  <  >=  <=  - 비교                               │
└────────────────────────────────────────────────────┘

예시:
• name contains "chrome"
• cpu > 5
• private_bytes > 100MB
• user equals "SYSTEM"
```

---

## 11. 플러그인 기능

### 11.1 내장 플러그인 목록

| 플러그인 | 기능 ID | 설명 |
|----------|---------|------|
| DotNetTools | PLG-001 | .NET 런타임 분석 |
| ExtendedTools | PLG-002 | ETW, GPU, NPU 모니터링 |
| HardwareDevices | PLG-003 | 디스크, 네트워크, 배터리 모니터링 |
| NetworkTools | PLG-004 | Ping, Traceroute, GeoIP |
| ExtendedServices | PLG-005 | 서비스 의존성, 복구, 트리거 |
| ExtendedNotifications | PLG-006 | 파일 로깅, 이벤트 알림 |
| ToolStatus | PLG-007 | 도구 모음 커스터마이징 |
| OnlineChecks | PLG-008 | VirusTotal, Hybrid Analysis |
| Updater | PLG-009 | 자동 업데이트 |
| UserNotes | PLG-010 | 프로세스 주석 |
| WindowExplorer | PLG-011 | 윈도우 탐색 |

### 11.2 DotNetTools 플러그인

**기능 ID**: PLG-001
**소스 파일**: `plugins/DotNetTools/`

#### 기능

- .NET 어셈블리 목록 표시
- CLR 버전 정보
- AppDomain 정보
- 스택 추적 (관리 코드)
- 성능 카운터 모니터링

### 11.3 ExtendedTools 플러그인

**기능 ID**: PLG-002
**소스 파일**: `plugins/ExtendedTools/`

#### 기능

| 기능 | 설명 |
|------|------|
| ETW 모니터링 | 디스크, 네트워크 I/O 추적 |
| GPU 모니터링 | GPU 사용률, 메모리 |
| NPU 모니터링 | NPU 사용률 |
| 프레임 모니터링 | FPS 추적 |
| 펌웨어 편집기 | UEFI/EFI 변수 |
| TPM 편집기 | TPM 정보 |

### 11.4 HardwareDevices 플러그인

**기능 ID**: PLG-003
**소스 파일**: `plugins/HardwareDevices/`

#### 기능

- 디스크 사용률 및 온도
- 네트워크 어댑터 통계
- GPU 정보 및 온도
- 배터리 상태
- 디바이스 트리

---

## 12. 알림 및 로깅 기능

### 12.1 시스템 트레이 알림

**기능 ID**: NOTIF-001
**소스 파일**: `SystemInformer/notifico.c`

#### 알림 이벤트

- 새 프로세스 생성
- 프로세스 종료
- 서비스 상태 변경
- 높은 CPU 사용량 경고

### 12.2 이벤트 로깅

**기능 ID**: NOTIF-002
**소스 파일**: `SystemInformer/logwnd.c`

#### 로그 정보

```
[2026-01-25 10:15:23] Process created: chrome.exe (PID: 1234)
[2026-01-25 10:15:45] Service started: Windows Update
[2026-01-25 10:16:02] High CPU: System Idle Process (98.5%)
[2026-01-25 10:16:30] Process terminated: notepad.exe (PID: 5678)
```

---

## 13. 설정 기능

### 13.1 일반 설정

**기능 ID**: OPT-001
**소스 파일**: `SystemInformer/options.c`

#### 설정 카테고리

| 카테고리 | 설정 항목 |
|----------|-----------|
| General | 시작 시 실행, 최소화 시작, 업데이트 확인 |
| Highlighting | 프로세스 하이라이팅 색상 |
| Graphs | 그래프 설정, 업데이트 간격 |
| Advanced | 드라이버 로드, 심볼 서버 |
| Plugins | 플러그인 활성화/비활성화 |

### 13.2 하이라이팅 설정

**기능 ID**: OPT-002

#### 하이라이팅 규칙

| 색상 | 의미 |
|------|------|
| 녹색 | 새로 생성된 프로세스 |
| 빨강 | 종료된 프로세스 |
| 분홍 | 서비스 프로세스 |
| 파랑 | 시스템 프로세스 |
| 보라 | 높은 권한 프로세스 |
| 노랑 | 패킹/보호된 프로세스 |
| 주황 | 일시 중지된 프로세스 |

---

## 14. 보안 기능

### 14.1 서명 검증

**기능 ID**: SEC-001
**소스 파일**: `phlib/verify.c`

#### 검증 상태

| 상태 | 설명 |
|------|------|
| Valid | 유효한 서명 |
| Invalid | 서명 손상 |
| Unsigned | 서명 없음 |
| Expired | 서명 만료 |
| Revoked | 인증서 폐기 |
| Untrusted | 신뢰할 수 없는 루트 |

### 14.2 프로세스 보호

**기능 ID**: SEC-002
**소스 파일**: `KSystemInformer/protection.c`

#### 보호 기능

- PPL (Protected Process Light) 우회
- 프로세스 숨기기 감지
- 커널 모드 작업 수행

---

## 15. 고해상도 공급자 (Low-Latency 모드)

**기능 ID**: PERF-001
**소스 파일**: `phlib/provider.c`, `phlib/include/provider.h`

#### 기능 설명

프로세스/네트워크 등 공급자 스레드의 타이머 정밀도를 높여 저지연 모니터링을 가능하게 합니다.

#### 주요 특징

| 항목 | 설명 |
|------|------|
| API | `PhSetHighResolutionProvider()` |
| 타이머 | Windows Timer2 API (`NtCreateTimer2`/`NtSetTimer2`) |
| 폴백 | Timer2 미지원 시 표준 타이머 사용 |
| 설정 | `EnableHighResolutionProviderTimer` |

---

## 16. 데스크톱 힙 감지

**기능 ID**: MEM-002
**소스 파일**: `SystemInformer/memprv.c`

#### 기능 설명

프로세스별 Win32 서브시스템 데스크톱 힙 할당을 식별하고 메모리 목록에 표시합니다.

#### 구현

- TEB → Win32ClientInfo → DesktopBase 포인터를 통해 감지
- 메모리 영역 분류에 `DesktopHeapRegion` 타입 추가
- 메모리 목록 뷰에 "Desktop heap" 레이블로 표시
- 스레드별 데스크톱 힙 추적 지원

---

## 17. 설정 자동 감지

**기능 ID**: CONF-001
**소스 파일**: `phlib/settings.c`

#### 기능 설명

설정 파일 형식을 자동으로 감지하고 최적의 저장소를 선택합니다. JSON, XML, KEY, Registry, Binary 형식을 지원하며, 포터블 모드를 자동으로 감지합니다.

---

## 18. 기능 요구사항 매트릭스

### 18.1 권한 요구사항

| 기능 | 일반 사용자 | 관리자 | 드라이버 필요 |
|------|-------------|--------|---------------|
| 프로세스 목록 | O | O | - |
| 프로세스 종료 | 일부 | 대부분 | 모든 프로세스 |
| 메모리 읽기 | 일부 | 대부분 | 보호된 프로세스 |
| 핸들 목록 | X | O | - |
| 서비스 관리 | X | O | - |
| 드라이버 로드 | X | X | 별도 서명 필요 |
| 데스크톱 힙 감지 | O | O | - |

### 18.2 Windows 버전별 지원

| 기능 | Win 10 | Win 11 |
|------|--------|--------|
| 기본 기능 | O | O |
| ETW 모니터링 | O | O |
| GPU 모니터링 | O | O |
| NPU 모니터링 | 일부 | O |
| 프로세스 보호 | O | O |
| ARM64 지원 | O | O |
| 고해상도 공급자 | O | O |
| 데스크톱 힙 감지 | O | O |
